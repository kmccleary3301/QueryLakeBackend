{
  "name": "Streaming Co-Author",
  "id": "demo_streaming_coauthor",
  "category": "demo",
  "initial_state": {
    "title": "Streaming Co-Author",
    "draft": {
      "text": "",
      "chunks": []
    }
  },
  "nodes": [
    {
      "id": "compose",
      "type": "api",
      "api_function": "llm",
      "inputs": {
        "chat_history": {
          "literal": [
            {
              "role": "system",
              "content": "You help expand outline bullets into a concise paragraph."
            },
            {
              "role": "user",
              "content": {
                "ref": {
                  "source": "inputs",
                  "path": "$.topic"
                }
              }
            }
          ]
        },
        "model_parameters": {
          "literal": {
            "temperature": 0.4,
            "max_tokens": 256,
            "stream": true
          }
        }
      },
      "mappings": [
        {
          "destination": {
            "kind": "state"
          },
          "path": "$.draft.text",
          "value": {
            "ref": {
              "source": "outputs",
              "path": "$.output"
            }
          },
          "mode": "append",
          "stream": {
            "enabled": true,
            "mode": "append",
            "initial": ""
          }
        },
        {
          "destination": {
            "kind": "state"
          },
          "path": "$.draft.chunks",
          "value": {
            "ref": {
              "source": "outputs",
              "path": "$.output"
            }
          },
          "mode": "append",
          "stream": {
            "enabled": true,
            "mode": "append",
            "initial": []
          }
        },
        {
          "destination": {
            "kind": "user"
          },
          "path": "$.draft",
          "value": {
            "ref": {
              "source": "state",
              "path": "$.draft"
            }
          },
          "mode": "set"
        }
      ]
    }
  ]
}
